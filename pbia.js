window.PbiaWorker=function(){function e(){}return e.init=function(){setTimeout(function(){e.postAll(!0)},2e3)},e.initContinue=function(){this.addPostWatcher(),e.postAll(!1)},e.postAll=function(t){for(var o=[];e.posts.length>0;)o.push(e.posts.shift());(o.length>0||null!=t&&t)&&e.post(o,t)},e.post=function(t,o){for(var s=[],n=0;n<t.length;n++)s.push({C:""+t[n].category,A:""+t[n].action,V:""+t[n].value});var i=JSON.stringify(s),r=new XMLHttpRequest;r.open("POST","https://hisanalytics.azurewebsites.net/api/event"),r.onload=function(){if(r.status>=200&&r.status<300){var t=r.getResponseHeader("his-s");null!=t&&e.storePbis(e.pbis=t),e.logToConsole&&console.log("[PBIA] "+i),null!=o&&o===!0&&e.initContinue()}},r.onerror=function(t){console.error(t),null!=o&&o===!0&&e.initContinue()},r.setRequestHeader("Content-Type","application/json;charset=UTF-8"),r.setRequestHeader("his-app","crm-powerbi-viewer"),null!=e.pbis&&r.setRequestHeader("his-s",e.pbis),r.send(i)},e.addPostWatcher=function(){Object.defineProperty(e.posts,"push",{configurable:!1,enumerable:!1,writable:!1,value:function(){e.post(arguments)}})},e.getStoredPbis=function(){var e=null;return sessionStorage&&sessionStorage.getItem&&(e=sessionStorage.getItem("pbia-s")),null==e||0==e.length?null:e},e.storePbis=function(e){sessionStorage&&sessionStorage.setItem&&null!=e&&sessionStorage.setItem("pbia-s",e)},e}(),PbiaWorker.posts=window.pbia=window.pbia||[],PbiaWorker.logToConsole=window.pbiaLocal||!1,PbiaWorker.pbis=PbiaWorker.getStoredPbis(),PbiaWorker.init();